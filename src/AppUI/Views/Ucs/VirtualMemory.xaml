<UserControl x:Class="NTMiner.Views.Ucs.VirtualMemory"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:local="clr-namespace:NTMiner.Views.Ucs"
        xmlns:controls="clr-namespace:NTMiner.Controls;assembly=NTMinerWpf"
        xmlns:vm="clr-namespace:NTMiner.Vms" Background="White"
        DataContext="{x:Static vm:PropertyViewModel.Current}"
        mc:Ignorable="d" Height="360" Width="800">
    <UserControl.Resources>
        <sys:String x:Key="WindowTitle">
            虚拟内存
        </sys:String>
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="*"></RowDefinition>
        </Grid.RowDefinitions>
        <WrapPanel HorizontalAlignment="Center">
            <TextBlock VerticalAlignment="Center">共设置了</TextBlock>
            <TextBlock FontSize="16" Margin="4 0" VerticalAlignment="Center" Text="{Binding DriveSet.VirtualMemorySet.TotalVirtualMemoryGbText}"></TextBlock>
            <TextBlock VerticalAlignment="Center">虚拟内存</TextBlock>
        </WrapPanel>
        <WrapPanel
            Grid.Row="1"
            HorizontalAlignment="Center" Margin="4"
            Visibility="{Binding DriveSet.VirtualMemorySet.IsStateChanged, Converter={StaticResource BoolToVisibilityConverter}}">
            <TextBlock VerticalAlignment="Center" Foreground="Red">虚拟内存已设置，重启电脑后生效</TextBlock>
            <controls:KbButton 
                Margin="8 0 0 0"
                Width="80"
                Background="{StaticResource MainColor}"
                Command="{x:Static vm:AppStatic.ShowRestartWindows}"
                VerticalAlignment="Center"
                CornerRadius="2">
                <WrapPanel>
                    <Path
                        Width="14"
                        Height="14"
                        Data="{StaticResource Icon_Restart}"
                        Fill="{StaticResource IconFillColor}"
                        Stretch="Fill" />
                    <Label 
                        Width="60"
                        Foreground="Red"
                        VerticalAlignment="Center"
                        Content="立即重启" />
                </WrapPanel>
            </controls:KbButton>
        </WrapPanel>
        <ItemsControl 
            Grid.Row="2"
            Background="Transparent"
            ItemsSource="{Binding DriveSet.Drives}"
            BorderThickness="0"
            ScrollViewer.VerticalScrollBarVisibility="Auto"
            ScrollViewer.HorizontalScrollBarVisibility="Disabled">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <WrapPanel>
                    </WrapPanel>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <StackPanel Width="340" Margin="20 30" Orientation="Horizontal">
                        <Path 
                            VerticalAlignment="Top"
                            Margin="4 4 6 0" 
                            Width="50" Height="50"
                            Data="{StaticResource Icon_Windows}"
                            Fill="{StaticResource IconFillColor}"
                            Stretch="Fill"
                            Visibility="{Binding IsSystemDisk, Converter={StaticResource BoolToHiddenConverter}}">
                        </Path>
                        <StackPanel>
                            <WrapPanel Margin="0">
                                <StackPanel Width="250">
                                    <WrapPanel>
                                        <TextBlock Text="{Binding VolumeLabel}"></TextBlock>
                                        <TextBlock>(</TextBlock>
                                        <TextBlock Text="{Binding Name}"></TextBlock>
                                        <TextBlock>)</TextBlock>
                                    </WrapPanel>
                                    <Border x:Name="BorderTotalSpace" Background="#E6E6E6" BorderBrush="{StaticResource LineColor}" BorderThickness="1">
                                        <WrapPanel>
                                            <Rectangle 
                                                Height="20" Width="{Binding HasUsedSpacePercent, ConverterParameter=250, Converter={StaticResource PercentToLengthConverter}}" 
                                                HorizontalAlignment="Left" Fill="#26A0DA"></Rectangle>
                                        </WrapPanel>
                                    </Border>
                                    <WrapPanel>
                                        <TextBlock Text="{Binding AvailableFreeSpace, Converter={StaticResource ByteToGbConverter}}"></TextBlock>
                                        <TextBlock>可用，共</TextBlock>
                                        <TextBlock Text="{Binding TotalSize, Converter={StaticResource ByteToGbConverter}}"></TextBlock>
                                    </WrapPanel>
                                </StackPanel>
                            </WrapPanel>
                            <Canvas>
                                <Slider 
									Minimum="0" 
									Maximum="7" 
									Width="250"
                                    TickFrequency="1"
                                    TickPlacement="BottomRight"
									LostFocus="VirtualMemorySlider_LostFocus"
									Value="{Binding VirtualMemory.MaxSizeLog2}"></Slider>
                                <WrapPanel Canvas.Top="24" Canvas.Left="-11">
                                    <WrapPanel.Resources>
                                        <Style TargetType="Button">
                                            <Setter Property="Cursor" Value="Hand"></Setter>
                                            <Setter Property="Width" Value="32"></Setter>
                                            <Setter Property="Margin" Value="1 0"></Setter>
                                            <Setter Property="Padding" Value="0"></Setter>
                                            <Setter Property="BorderThickness" Value="0"></Setter>
                                            <Setter Property="Background" Value="Transparent"></Setter>
                                        </Style>
                                    </WrapPanel.Resources>
                                    <Button Command="{Binding Set}" CommandParameter="0">0G</Button>
                                    <Button Command="{Binding Set}" CommandParameter="1">2G</Button>
                                    <Button Command="{Binding Set}" CommandParameter="2">4G</Button>
                                    <Button Command="{Binding Set}" CommandParameter="3">8G</Button>
                                    <Button Command="{Binding Set}" CommandParameter="4">16G</Button>
                                    <Button Command="{Binding Set}" CommandParameter="5">32G</Button>
                                    <Button Command="{Binding Set}" CommandParameter="6">64G</Button>
                                    <Button Command="{Binding Set}" CommandParameter="7">128G</Button>
                                </WrapPanel>
                                <TextBox Canvas.Left="250" Width="48" Background="White" Text="{Binding VirtualMemory.MaxSizeMb}"></TextBox>
                                <TextBlock Canvas.Left="300">Mb</TextBlock>
                            </Canvas>
                        </StackPanel>
                    </StackPanel>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </Grid>
</UserControl>
